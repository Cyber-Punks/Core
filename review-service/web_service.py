import falcon
import json
import urllib
import os
import requests

# SENTINEL_PORT = os.getenv('SENTINEL_PORT')
# REDDIT_SCRAPER_PORT = os.getenv('REDDIT_SCRAPER_PORT')
# DATABASE_PORT = os.getenv('DATABASE_PORT')

SCORE_CUTOFF = -0.7
MAGNITUDE_CUTOFF = 0.7

SENTINEL_PORT = '8000'
REDDIT_SCRAPER_PORT = '8080'
DATABASE_PORT = '8000'

SENTINEL_URL = 'http://localhost:' + SENTINEL_PORT
REDDIT_SCRAPER_URL = 'http://localhost:' + REDDIT_SCRAPER_PORT
DATABASE_URL = 'http://localhost:' + DATABASE_PORT

content_node = {
    "source": "reddit.com/rdoggos",
    "name": "subreddit",
    "body": "",
    "children": [
        {
            "source": "reddit.com/r/doggos/comments/kg7a3s/never_let_your_dog_eat_skittles/",
            "name": "submission",
            "body": "",
            "children": [
                {
                    "source": "reddit.com/r/doggos/comments/kg7a3s/never_let_your_dog_eat_skittles/ggcsur1/",
                    "name": "comment",
                    "body": "Best.  Title.  Ever.",
                    "children": []},
                    {
                        "source": "reddit.com/r/doggos/comments/kg7a3s/never_let_your_dog_eat_skittles/ggd32cf/",
                        "name": "comment", "body": "Smell the rainbow, taste the rainbow.",
                        "children": [
                            {
                                "source": "reddit.com/r/doggos/comments/kg7a3s/never_let_your_dog_eat_skittles/ggfzrnp/",
                                "name": "comment",
                                "body": "Classic ^",
                                "children":
                                    {
                                        "source": "reddit.com/r/doggos/comments/kg7a3s/never_let_your_dog_eat_skittles/ggfzrnp/",
                                        "name": "comment",
                                        "body": "Classic ^",
                                        "children": []}}]},
                                        {
                                            "source": "reddit.com/r/doggos/comments/kg7a3s/never_let_your_dog_eat_skittles/ggd4brw/",
                                            "name": "comment",
                                            "body": "Screw nyan cat... We have nyan dog",
                                            "children": [{"source": "reddit.com/r/doggos/comments/kg7a3s/never_let_your_dog_eat_skittles/ggdp0ue/", "name": "comment", "body": "*Wan Dog", "children": {"source": "reddit.com/r/doggos/comments/kg7a3s/never_let_your_dog_eat_skittles/ggdp0ue/", "name": "comment", "body": "*Wan Dog", "children": []}}]}, {"source": "reddit.com/r/doggos/comments/kg7a3s/never_let_your_dog_eat_skittles/ggda77q/", "name": "comment", "body": " A ray of sunshine \ud83e\udd23", "children": []}, {"source": "reddit.com/r/doggos/comments/kg7a3s/never_let_your_dog_eat_skittles/ggfua87/", "name": "comment", "body": "Poop the rainbow \ud83c\udf08", "children": []}, {"source": "reddit.com/r/doggos/comments/kg7a3s/never_let_your_dog_eat_skittles/ggfzqbl/", "name": "comment", "body": "At first I was worried about the rainbow bridge, but then I noticed it was coming out of his butt, so that makes it funny!!", "children": []}, {"source": "reddit.com/r/doggos/comments/kg7a3s/never_let_your_dog_eat_skittles/ggdrwyv/", "name": "comment", "body": "Give that majestic beast more skittles. They\u2019ve earned it.", "children": []}, {"source": "reddit.com/r/doggos/comments/kg7a3s/never_let_your_dog_eat_skittles/gge0zkh/", "name": "comment", "body": "that's one rainbow I certainly don't want to taste", "children": []}, {"source": "reddit.com/r/doggos/comments/kg7a3s/never_let_your_dog_eat_skittles/gge9av8/", "name": "comment", "body": "Waste, the rainbow.", "children": []}, {"source": "reddit.com/r/doggos/comments/kg7a3s/never_let_your_dog_eat_skittles/ggehdb6/", "name": "comment", "body": "You can almost hear the chorus of angels", "children": []}, {"source": "reddit.com/r/doggos/comments/kg7a3s/never_let_your_dog_eat_skittles/ggen6bs/", "name": "comment", "body": "Someone crosspost this to r/funny the world needs more laughter!", "children": []}, {"source": "reddit.com/r/doggos/comments/kg7a3s/never_let_your_dog_eat_skittles/ggfpxmo/", "name": "comment", "body": "Oh the photoshop possibilities!! \ud83e\udd29", "children": []}]}, {"source": "reddit.com/r/doggos/comments/kg74k4/he_is_beauty_he_is_grace_he_is_a_fluffyboy/", "name": "submission", "body": "", "children": [{"source": "reddit.com/r/doggos/comments/kg74k4/he_is_beauty_he_is_grace_he_is_a_fluffyboy/ggctvjb/", "name": "comment", "body": "Glorious pupper.", "children": []}, {"source": "reddit.com/r/doggos/comments/kg74k4/he_is_beauty_he_is_grace_he_is_a_fluffyboy/ggd09x7/", "name": "comment", "body": "Now this is the most majestic creature I ever did see", "children": []}]}, {"source": "reddit.com/r/doggos/comments/kglsaj/am_i_too_late_to_pick_up_grogu/", "name": "submission", "body": "", "children": [{"source": "reddit.com/r/doggos/comments/kglsaj/am_i_too_late_to_pick_up_grogu/ggfm0r1/", "name": "comment", "body": "@sablethesamoyed", "children": []}]}, {"source": "reddit.com/r/doggos/comments/kfztzk/schnauz_of_anarchy/", "name": "submission", "body": "", "children": [{"source": "reddit.com/r/doggos/comments/kfztzk/schnauz_of_anarchy/ggc4df9/", "name": "comment", "body": "Prison Mike, is that you?", "children": []}, {"source": "reddit.com/r/doggos/comments/kfztzk/schnauz_of_anarchy/ggc2qfa/", "name": "comment", "body": "Fucking dog has fucking papers. This is not \u2018Nam, this is Reddit. There are rules", "children": []}, {"source": "reddit.com/r/doggos/comments/kfztzk/schnauz_of_anarchy/ggcb82y/", "name": "comment", "body": "He does look like the leader of a motorcycle gang, that would have no regrets for breaking your knees over some perceived disrespect!!\n\nI hope you can save him before his debauchery gets him in to something he can\u2019t get out of. I\u2019m worried sick. Have you thought about an intervention, maybe? I don\u2019t know, I\u2019m grasping at straws, but I\u2019ve seen too many innocent canines  wickedly deceived by the dark side. And, it rarely ends well! Please keep us posted on your progress!! Good luck \n\nEdit: This is just a farce comment from a bored person. Nothing more. I know my spelling and grammar are shite,Thanks!", "children": []}, {"source": "reddit.com/r/doggos/comments/kfztzk/schnauz_of_anarchy/ggc3p5i/", "name": "comment", "body": "Do you have Facebook??? Schnauzers 4 life would LOVE this. As I do lol", "children": [{"source": "reddit.com/r/doggos/comments/kfztzk/schnauz_of_anarchy/ggd5ucg/", "name": "comment", "body": "Thanks for the tip I'll check it out! \ud83d\ude0a", "children": {"source": "reddit.com/r/doggos/comments/kfztzk/schnauz_of_anarchy/ggd5ucg/", "name": "comment", "body": "Thanks for the tip I'll check it out! \ud83d\ude0a", "children": []}}]}, {"source": "reddit.com/r/doggos/comments/kfztzk/schnauz_of_anarchy/ggckro3/", "name": "comment", "body": "SWEG", "children": []}, {"source": "reddit.com/r/doggos/comments/kfztzk/schnauz_of_anarchy/ggcre4z/", "name": "comment", "body": "This lil dude has the best vibe, love him.", "children": []}]}, {"source": "reddit.com/r/doggos/comments/kglg2o/model_status/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/kg5tc0/pickle_the_tiny_puppa/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/kfznar/my_pup_has_finally_healed_from_double_cataract/", "name": "submission", "body": "", "children": [{"source": "reddit.com/r/doggos/comments/kfznar/my_pup_has_finally_healed_from_double_cataract/ggbtbc9/", "name": "comment", "body": "Aww! How exciting to see again!", "children": []}, {"source": "reddit.com/r/doggos/comments/kfznar/my_pup_has_finally_healed_from_double_cataract/ggc5twf/", "name": "comment", "body": "That\u2019s amazing!", "children": []}, {"source": "reddit.com/r/doggos/comments/kfznar/my_pup_has_finally_healed_from_double_cataract/ggco22f/", "name": "comment", "body": "Great recovery to your pup! :)", "children": []}, {"source": "reddit.com/r/doggos/comments/kfznar/my_pup_has_finally_healed_from_double_cataract/ggcsgjl/", "name": "comment", "body": "Oh little angel. I\u2019m so glad they\u2019re feeling better now! Adorable baby", "children": []}, {"source": "reddit.com/r/doggos/comments/kfznar/my_pup_has_finally_healed_from_double_cataract/ggdbc7s/", "name": "comment", "body": "I remember doing the eye drop regimen post surgery on a family dachshund who had this done.  It\u2019s a lot of post op care, but so worth it.", "children": []}]}, {"source": "reddit.com/r/doggos/comments/kg7ffe/same_shoe_and_same_doggo/", "name": "submission", "body": "", "children": [{"source": "reddit.com/r/doggos/comments/kg7ffe/same_shoe_and_same_doggo/ggd6rz6/", "name": "comment", "body": "There is something so sweet about a doggo so attached to the first comfort toy!", "children": []}]}, {"source": "reddit.com/r/doggos/comments/kgiybn/malamutes_epic_fail_at_romancelmbo/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/kg1zuo/you_have_been_hot_dogged_upvote_for_doggo_to_drop/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/kfl4dl/snow_brawls_are_the_best/", "name": "submission", "body": "", "children": [{"source": "reddit.com/r/doggos/comments/kfl4dl/snow_brawls_are_the_best/gg9d6xx/", "name": "comment", "body": "They look like school girls who just got a hot date, doing a squeee", "children": []}, {"source": "reddit.com/r/doggos/comments/kfl4dl/snow_brawls_are_the_best/ggbkrj2/", "name": "comment", "body": "Get them doggos a sled. You could let Santa retire!", "children": []}]}, {"source": "reddit.com/r/doggos/comments/kgfgkl/we_interrogated_him_for_a_very_long_time_he_didnt/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/kg9dt2/camping_doggo_waking_up_on_a_cold_morning_in_the/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/kg8zy3/my_very_good_shrimp_scampi_in_front_of_the_tree/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/kgartq/i_can_be_happy_anywhere_with_you_malamute_husky/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/kgaief/silly_noisy_puppy/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/kg4ck2/meet_tobi/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/kgc8x5/i_made_a_short_and_fun_video_of_yesterdays_shoob/", "name": "submission", "body": "", "children": [{"source": "reddit.com/r/doggos/comments/kgc8x5/i_made_a_short_and_fun_video_of_yesterdays_shoob/ggdrch8/", "name": "comment", "body": "I've been having a lot of fun making videos lately and plan on making a lot more. If you enjoyed this, please consider subscribing to this new channel. It would mean a lot to me and the doggos!", "children": []}]}, {"source": "reddit.com/r/doggos/comments/kg9vej/growing_up_shih_tzu_during_holidays/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/kg2fkj/thats_her_son_eating/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/kfwwfg/co_conspirators_never_found_out_what_they_were_up/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/kg246w/pet_me_more_hooman/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/kfyo9x/i_wasnt_expecting_tonka_to_do_this_but_i_should/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/kfngaa/my_doggo_bonus_kitten/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/keyvzx/she_eats_the_snew_the_world_is_one_big_snow_cone/", "name": "submission", "body": "", "children": [{"source": "reddit.com/r/doggos/comments/keyvzx/she_eats_the_snew_the_world_is_one_big_snow_cone/gg65joj/", "name": "comment", "body": "Northeast?", "children": [{"source": "reddit.com/r/doggos/comments/keyvzx/she_eats_the_snew_the_world_is_one_big_snow_cone/gg65vrh/", "name": "comment", "body": "Yes! NYC :)", "children": {"source": "reddit.com/r/doggos/comments/keyvzx/she_eats_the_snew_the_world_is_one_big_snow_cone/gg65vrh/", "name": "comment", "body": "Yes! NYC :)", "children": [{"source": "reddit.com/r/doggos/comments/keyvzx/she_eats_the_snew_the_world_is_one_big_snow_cone/gg68dc8/", "name": "comment", "body": "Ha same", "children": {"source": "reddit.com/r/doggos/comments/keyvzx/she_eats_the_snew_the_world_is_one_big_snow_cone/gg68dc8/", "name": "comment", "body": "Ha same", "children": []}}]}}]}, {"source": "reddit.com/r/doggos/comments/keyvzx/she_eats_the_snew_the_world_is_one_big_snow_cone/gg6aj66/", "name": "comment", "body": "I mean, lickable water", "children": []}, {"source": "reddit.com/r/doggos/comments/keyvzx/she_eats_the_snew_the_world_is_one_big_snow_cone/gg8bs2o/", "name": "comment", "body": "She eats the snew, then runs like pew pew.", "children": []}, {"source": "reddit.com/r/doggos/comments/keyvzx/she_eats_the_snew_the_world_is_one_big_snow_cone/gg8om2w/", "name": "comment", "body": "I definitely read \"she eats the sinew\" and was properly confused. It took me a bit to figure out what sub I was in and what part of snow has skin or muscle tissue.", "children": []}]}, {"source": "reddit.com/r/doggos/comments/kfzhns/doggo_eating_apple_might_be_cutest_thing_ever/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/kfr9y0/petting_doggo/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/kfpbr7/frontfacing_plimpton_in_full_stride/", "name": "submission", "body": "", "children": [{"source": "reddit.com/r/doggos/comments/kfpbr7/frontfacing_plimpton_in_full_stride/ggdb79c/", "name": "comment", "body": "Amazzzeeee", "children": []}]}, {"source": "reddit.com/r/doggos/comments/kezke7/little_paco_rocking_his_new_outfit_my_mom_made_him/", "name": "submission", "body": "", "children": [{"source": "reddit.com/r/doggos/comments/kezke7/little_paco_rocking_his_new_outfit_my_mom_made_him/gg62iuc/", "name": "comment", "body": "can i hug him?", "children": []}, {"source": "reddit.com/r/doggos/comments/kezke7/little_paco_rocking_his_new_outfit_my_mom_made_him/gg6gxqr/", "name": "comment", "body": "Tell Paco he\u2019s awesome", "children": []}, {"source": "reddit.com/r/doggos/comments/kezke7/little_paco_rocking_his_new_outfit_my_mom_made_him/gg6ryd5/", "name": "comment", "body": "Aww he's adorable!!! I just got a pug last month and named him Paco as well!! Paco club woot woot!! :)", "children": []}, {"source": "reddit.com/r/doggos/comments/kezke7/little_paco_rocking_his_new_outfit_my_mom_made_him/gg7njlp/", "name": "comment", "body": "That\u2019s adorable. Your mom needs some pictures with Paco doing manly things in his winter duds. Climbing a mountain of snow, handling large tools, wrestling a bear.", "children": [{"source": "reddit.com/r/doggos/comments/kezke7/little_paco_rocking_his_new_outfit_my_mom_made_him/gg9k8q0/", "name": "comment", "body": "Best comment ever. I\u2019ll tag you if this happens", "children": {"source": "reddit.com/r/doggos/comments/kezke7/little_paco_rocking_his_new_outfit_my_mom_made_him/gg9k8q0/", "name": "comment", "body": "Best comment ever. I\u2019ll tag you if this happens", "children": []}}]}, {"source": "reddit.com/r/doggos/comments/kezke7/little_paco_rocking_his_new_outfit_my_mom_made_him/gg78is9/", "name": "comment", "body": "laughed out loud! adorable!", "children": []}, {"source": "reddit.com/r/doggos/comments/kezke7/little_paco_rocking_his_new_outfit_my_mom_made_him/gg7hrto/", "name": "comment", "body": "Those ears are fantastic.", "children": []}]}, {"source": "reddit.com/r/doggos/comments/kfafdd/you_think_teachers_will_understand_why_my/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/", "name": "submission", "body": "", "children": [{"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg3movx/", "name": "comment", "body": "She looks awesome! Perfect stress reliever", "children": [{"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg4rvxw/", "name": "comment", "body": "Stress *retriever*", "children": {"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg4rvxw/", "name": "comment", "body": "Stress *retriever*", "children": [{"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg4u6xk/", "name": "comment", "body": "Beat me to it lol \ud83d\ude02 \ud83d\ude02", "children": {"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg4u6xk/", "name": "comment", "body": "Beat me to it lol \ud83d\ude02 \ud83d\ude02", "children": []}}, {"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg5fszk/", "name": "comment", "body": "Underrated comment, enjoy your seal!!", "children": {"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg5fszk/", "name": "comment", "body": "Underrated comment, enjoy your seal!!", "children": [{"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg5fzc9/", "name": "comment", "body": "Lol thanks. I love my lil seal", "children": {"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg5fzc9/", "name": "comment", "body": "Lol thanks. I love my lil seal", "children": []}}]}}]}}]}, {"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg3gp93/", "name": "comment", "body": "The bestest girl", "children": [{"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg3xwpi/", "name": "comment", "body": "Yes she is.", "children": {"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg3xwpi/", "name": "comment", "body": "Yes she is.", "children": []}}]}, {"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg5dq56/", "name": "comment", "body": "The best thing to come from COVID is, \u201ctake your dog to school day\u201d gets to happen all the time! She\u2019s a sweet lady pup to come in and cheer you up.", "children": [{"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg5fid1/", "name": "comment", "body": "It does when I\u2019m online. I\u2019m in person for now so sadly I can\u2019t have her at school", "children": {"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg5fid1/", "name": "comment", "body": "It does when I\u2019m online. I\u2019m in person for now so sadly I can\u2019t have her at school", "children": []}}]}, {"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg42ati/", "name": "comment", "body": "She has immense love. She\u2019s gorgeous", "children": []}, {"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg473t6/", "name": "comment", "body": "Ahh, what a beautiful girl!!! I love how tuned in Goldens are, in regards to our mental state. Most dogs are, but seems like goldens are just really good at it!!", "children": []}, {"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg49l4y/", "name": "comment", "body": "Doggos are wonderful mental therapy!", "children": []}, {"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg4d1d3/", "name": "comment", "body": "Dogs really are the best\u2764\ufe0f", "children": []}, {"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg4i1ai/", "name": "comment", "body": "Calm retriever \u2764\ufe0f", "children": []}, {"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg55yot/", "name": "comment", "body": "Gotta tap that snoot!", "children": []}, {"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg560yq/", "name": "comment", "body": "Is that BB-8 on the right?", "children": [{"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg590ws/", "name": "comment", "body": "Yeah. It\u2019s a remote control robot that I got. Good eye", "children": {"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg590ws/", "name": "comment", "body": "Yeah. It\u2019s a remote control robot that I got. Good eye", "children": [{"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg5lomr/", "name": "comment", "body": "Thx :D", "children": {"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg5lomr/", "name": "comment", "body": "Thx :D", "children": []}}]}}]}, {"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg5ivl5/", "name": "comment", "body": "This made my day 1000 times better", "children": []}, {"source": "reddit.com/r/doggos/comments/kem978/i_was_stressed_from_homework_and_she_came_in_to/gg5z66r/", "name": "comment", "body": "I thought you were gonna say she came in and ate it for you. Lol \u201cWell, that\u2019s that, I guess!\u201d", "children": []}]}, {"source": "reddit.com/r/doggos/comments/kfcrkq/ill_sleep_where_i_want/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/keyxk3/winter_is_officially_here/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/kf2kc4/when_its_snack_time_every_night_at_7pm_and_she/", "name": "submission", "body": "", "children": [{"source": "reddit.com/r/doggos/comments/kf2kc4/when_its_snack_time_every_night_at_7pm_and_she/gg6enhy/", "name": "comment", "body": "So cute! She definitely won't let you forget haha.\n\nHere's my old man, https://ibb.co/kVTr5YK", "children": [{"source": "reddit.com/r/doggos/comments/kf2kc4/when_its_snack_time_every_night_at_7pm_and_she/gg6jix3/", "name": "comment", "body": "Aw he is so precious! And she definitely won\u2019t. She\u2019ll stare at me until she gets her daily treat. It can make someone very uncomfortable after a while \ud83d\ude02", "children": {"source": "reddit.com/r/doggos/comments/kf2kc4/when_its_snack_time_every_night_at_7pm_and_she/gg6jix3/", "name": "comment", "body": "Aw he is so precious! And she definitely won\u2019t. She\u2019ll stare at me until she gets her daily treat. It can make someone very uncomfortable after a while \ud83d\ude02", "children": [{"source": "reddit.com/r/doggos/comments/kf2kc4/when_its_snack_time_every_night_at_7pm_and_she/gg6ovxj/", "name": "comment", "body": "Thats wicked adorable haha. How old is she? My dog, Dunkin, is turning 16 in May. He's starting to get up there", "children": {"source": "reddit.com/r/doggos/comments/kf2kc4/when_its_snack_time_every_night_at_7pm_and_she/gg6ovxj/", "name": "comment", "body": "Thats wicked adorable haha. How old is she? My dog, Dunkin, is turning 16 in May. He's starting to get up there", "children": []}}]}}]}]}, {"source": "reddit.com/r/doggos/comments/kf37xy/make_sure_you_get_my_good_side/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/keybm2/if_this_isnt_the_definition_of_puppy_dog_eyes_idk/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/kf49ly/weve_got_a_heck_of_a_trek_to_get_to_snowcone_alley/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/kee8iq/so_this_is_my_little_frankie_girl_she_needs_a/", "name": "submission", "body": "", "children": [{"source": "reddit.com/r/doggos/comments/kee8iq/so_this_is_my_little_frankie_girl_she_needs_a/gg3a4b3/", "name": "comment", "body": "As a professional groomer, I can zoom in on the last photo and see that Frankie is matted. If you don\u2019t want her to be shaved down naked I advise you to thoroughly brush AND comb her coat before an appointment. Most groomers will not dematt dogs when it gets to a certain point due to how painful and traumatizing it can be. (It\u2019s literally ripping the hair out, ouchhhh) If she has matted, you probably won\u2019t have much of a choice on what kind of haircut she will get. YouTube has many informative videos on how to properly brush and comb your pet at home. Our clipper blades can\u2019t go through the matting, they can only go underneath, so depending on how tight the knots are determines how short her hair will have to be. Best of luck! Feel free to ask me anything, whether it is techniques or proper tools to use.", "children": []}, {"source": "reddit.com/r/doggos/comments/kee8iq/so_this_is_my_little_frankie_girl_she_needs_a/gg2dehl/", "name": "comment", "body": "Her hair looks like it might lay flat light a schnauzer breed while bichons have more cottony/poodles fur. A lamb cut is cute in terrier breeds, but don't expect it to be poofy like a bichons lol. Sometimes hair doesn't want to do what we want it to. She looks kinda tangled. If you can't get a brush through her fur, the groomer might have to go short for her first groom. If that's the case then be patient as dog hair grows back fast! She's suuuuper cute btw!!", "children": []}, {"source": "reddit.com/r/doggos/comments/kee8iq/so_this_is_my_little_frankie_girl_she_needs_a/gg2fcmr/", "name": "comment", "body": "Hi there! What a sweet little pup. I've always had small dogs and gotten \"teddy bear cuts\" from multiple groomers. A teddy bear cut is short hair on the pup's body, trimmed yet fluffy legs, hair trimmed around their feet and paws, long/flowy tail, and a short yet rounded face. The ears are usually trimmed in line with the shape of the pup's face, unless you specifically ask the groomer that the ears be cut shorter/kept longer, depending on your preference and your dog's lifestyle. Many groomers will also ask if you want to leave a \"topknot\" (a ponytail). Unless you're prepared to train Frankie to accept a ponytail on top of her head, along with the maintenance of keeping that longer hair tangle-free and out of her eyes, I'd recommend just keeping the hair short. Last tip, make sure you ask the groomer to check your pup's anal glands to see if they need expressing during the groom. If you've never done that yourself before, trust me...you don't want to! \n\nAfter 20 years of owning small dogs, I think the teddy bear cut is the best to avoid nasty tangles or matting in hair textured like your girl's. Good luck and please post update pics once Frankie has had her day at the spa!", "children": []}, {"source": "reddit.com/r/doggos/comments/kee8iq/so_this_is_my_little_frankie_girl_she_needs_a/gg2bmze/", "name": "comment", "body": "I've got a pup mix with similar characteristics. We usually get his coat fairly short, and a teddy bear face. If she doesn't wear sweaters (our dudes do), maybe don't go too short on the body. She's ADORABLE.", "children": []}, {"source": "reddit.com/r/doggos/comments/kee8iq/so_this_is_my_little_frankie_girl_she_needs_a/gg2devm/", "name": "comment", "body": "Talk it over with your groomers", "children": []}, {"source": "reddit.com/r/doggos/comments/kee8iq/so_this_is_my_little_frankie_girl_she_needs_a/gg3ie1s/", "name": "comment", "body": "My doggo is also named Frankie! She\u2019s a rescue but also has a lot of terrier in her", "children": []}, {"source": "reddit.com/r/doggos/comments/kee8iq/so_this_is_my_little_frankie_girl_she_needs_a/gg2f91n/", "name": "comment", "body": "She is gorgeous!", "children": []}, {"source": "reddit.com/r/doggos/comments/kee8iq/so_this_is_my_little_frankie_girl_she_needs_a/gg2j9mh/", "name": "comment", "body": "She is absolutely adorable. I love fluffy doggos.", "children": []}, {"source": "reddit.com/r/doggos/comments/kee8iq/so_this_is_my_little_frankie_girl_she_needs_a/gg2wcm2/", "name": "comment", "body": "Probably will need short and sweet if she's a puppy not used to grooming, I would do a quick all over short with tedy legs, but don't stree over leaving too long, with all the matts showing there. Positive experience beats cute time consuming first cuts.", "children": []}]}, {"source": "reddit.com/r/doggos/comments/kevrdz/dreaming_of_going_back_to_the_summer_days_we_left/", "name": "submission", "body": "", "children": [{"source": "reddit.com/r/doggos/comments/kevrdz/dreaming_of_going_back_to_the_summer_days_we_left/gg4y6qp/", "name": "comment", "body": "So how many messages did you get in your inbox for the r4r?\n\nWhen I saw your photo ( gorgeous btw) I felt sorry for your poor inbox haha ;)", "children": [{"source": "reddit.com/r/doggos/comments/kevrdz/dreaming_of_going_back_to_the_summer_days_we_left/ggctdgi/", "name": "comment", "body": "Why would you comment this on a post that hasn\u2019t anything to do with r4r? Bit weird.", "children": {"source": "reddit.com/r/doggos/comments/kevrdz/dreaming_of_going_back_to_the_summer_days_we_left/ggctdgi/", "name": "comment", "body": "Why would you comment this on a post that hasn\u2019t anything to do with r4r? Bit weird.", "children": [{"source": "reddit.com/r/doggos/comments/kevrdz/dreaming_of_going_back_to_the_summer_days_we_left/ggcxe2r/", "name": "comment", "body": "Sorry- I couldn\u2019t comment on the r4r post because it\u2019s locked.\n\nAnyway- hope we can chat!", "children": {"source": "reddit.com/r/doggos/comments/kevrdz/dreaming_of_going_back_to_the_summer_days_we_left/ggcxe2r/", "name": "comment", "body": "Sorry- I couldn\u2019t comment on the r4r post because it\u2019s locked.\n\nAnyway- hope we can chat!", "children": [{"source": "reddit.com/r/doggos/comments/kevrdz/dreaming_of_going_back_to_the_summer_days_we_left/ggdeqjy/", "name": "comment", "body": "I most likely won\u2019t, have a good weekend.", "children": {"source": "reddit.com/r/doggos/comments/kevrdz/dreaming_of_going_back_to_the_summer_days_we_left/ggdeqjy/", "name": "comment", "body": "I most likely won\u2019t, have a good weekend.", "children": []}}]}}]}}]}]}, {"source": "reddit.com/r/doggos/comments/kf2dzm/alaskan_malamutes_playtime_with_hedgehog_while_in/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/key75p/morning_plays_look_at_them_teef/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/kf3qg8/rocky_thinks_he_needs_to_protect_me_when_dogs/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/keq27s/good_girl_in_her_natural_habitat/", "name": "submission", "body": "", "children": [{"source": "reddit.com/r/doggos/comments/keq27s/good_girl_in_her_natural_habitat/gg4c2y7/", "name": "comment", "body": "Needs a stiff beating! I would love to beat the shit out of your dog!", "children": []}]}, {"source": "reddit.com/r/doggos/comments/keas61/little_paco_soaking_up_the_warmth_on_this_cold_day/", "name": "submission", "body": "", "children": [{"source": "reddit.com/r/doggos/comments/keas61/little_paco_soaking_up_the_warmth_on_this_cold_day/gg3nmfu/", "name": "comment", "body": "Ahahah hes awesome!", "children": []}]}, {"source": "reddit.com/r/doggos/comments/kengvc/snow_doggo/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/keqt8c/fred_will_do_anything_for_cookies/", "name": "submission", "body": "", "children": [{"source": "reddit.com/r/doggos/comments/keqt8c/fred_will_do_anything_for_cookies/gg48mlt/", "name": "comment", "body": "anything? \ud83d\ude0f", "children": []}, {"source": "reddit.com/r/doggos/comments/keqt8c/fred_will_do_anything_for_cookies/gg49167/", "name": "comment", "body": "But he won't do that.", "children": []}, {"source": "reddit.com/r/doggos/comments/keqt8c/fred_will_do_anything_for_cookies/gg4c1h4/", "name": "comment", "body": "Even anal? I would love to beat your dog to death and stuff his ass", "children": []}]}, {"source": "reddit.com/r/doggos/comments/keq09f/happy_holidays_from_tiny_dinky_daffy/", "name": "submission", "body": "", "children": []}, {"source": "reddit.com/r/doggos/comments/kenkid/boston_was_not_happy_i_filmed_his_yawn/", "name": "submission", "body": "", "children": [{"source": "reddit.com/r/doggos/comments/kenkid/boston_was_not_happy_i_filmed_his_yawn/gg3kdr2/", "name": "comment", "body": "Grouchy or not, that\u2019s a highly squishable face . \ud83e\udd7a", "children": []}]}, {"source": "reddit.com/r/doggos/comments/kelul9/my_new_little_girl_luna/", "name": "submission", "body": "", "children": [{"source": "reddit.com/r/doggos/comments/kelul9/my_new_little_girl_luna/gg4c53f/", "name": "comment", "body": "I will fuck your dog for cash. Pay me money and I will fuck your dog HARD", "children": [{"source": "reddit.com/r/doggos/comments/kelul9/my_new_little_girl_luna/gg4xk9x/", "name": "comment", "body": "Well how bout you stfu you creepy son of a bitch", "children": {"source": "reddit.com/r/doggos/comments/kelul9/my_new_little_girl_luna/gg4xk9x/", "name": "comment", "body": "Well how bout you stfu you creepy son of a bitch", "children": []}}]}]}, {"source": "reddit.com/r/doggos/comments/kejmae/oil_painting_of_hank/", "name": "submission", "body": "", "children": [{"source": "reddit.com/r/doggos/comments/kejmae/oil_painting_of_hank/gg4c7tw/", "name": "comment", "body": "You painted a generic old lady dog. Congrats. Now toss it in the dumpster where it belongs. And go ahead and throw yourself in there too", "children": []}]}]}


class ContentResource(object):

    def on_get(self, req, resp):
        test = '{"source": "https://old.reddit.com/r/doggos/comments/kg7a3s/never_let_your_dog_eat_skittles/"}'
        # content = ContentNode
        # content_node = scrape(test)
        bad_subjects = []
        analysis = get_analysis(content_node, bad_subjects)
        print(bad_subjects)
        resp.status = falcon.HTTP_200

    def on_post(self, req, resp):
        scraped_data = scrape(req)
        resp.status = falcon.HTTP_200


# Check the database
def check_resource(req):
    pass


# Send to scraper
def scrape(req):
    data = json.loads(req)['source']
    com = data.find('.com') + 5
    trimmed_url = data[com:]
    uri = urllib.parse.urlencode({'uri': trimmed_url})
    # content = requests.get(REDDIT_SCRAPER_URL + '/content?' + uri)
    return content


# Get sentiment analysis
def get_analysis(node, bad_subjects):
    process_node(node, bad_subjects)
    if not node['children']:
        pass
    else:
        # process children
        for child in node['children']:
            return get_analysis(child, bad_subjects)


def process_node(node, bad_subjects):
    resp = requests.post(SENTINEL_URL + '/sentiment', data=node)
    naughty = resp['naughty']
    node['naughty'] = naughty
    node['subjects'] = resp['subjects']
    if naughty:
        for subject in node.subjects:
            if subject['score'] < SCORE_CUTOFF and subject['magnitude'] > MAGNITUDE_CUTOFF:
                added = False
                for bad_subject in bad_subjects:
                    if subject['name'] == bad_subjects['name']:
                        bad_subject['score'] = (bad_subject['score'] + subject['score'])/2
                        bad_subject['magnitude'] = (bad_subject['magnitude'] + subject['magnitude'])/2
                        added = True
                        break
                if not added:
                    bad_subjects.append(subject)


api = application = falcon.API()

content = ContentResource()
api.add_route('/api/analyse', content)
